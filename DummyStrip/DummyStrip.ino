#include "settings.h"

#define WIFI
#include "arduino_pi.h"


void setup() {
      Serial.begin(115200);  
#ifdef WIFI
    while(!setup_cc3000());  //loop until it connects to wifi
    if(Serial)
    {
        Serial.print("Connecting to IP:");
        Serial.print(IP);
        Serial.print(" Port number:");
        Serial.println(PORTNO);
    }
    while(!tcp_connect(IP, PORTNO))  //loop 
        if(Serial)
            Serial.print("Could not connect. Retrying...");
    if(Serial)
      Serial.print("Connected!\n"); 
#endif    
}

void serialEvent() {
  while(Serial.available()){
        byte new_data = Serial.read();
        Serial.print(new_data);
        //do something with the serial data
  }
}







float wifi_package[16][10] = {
{15.14, 0.58, -23102.39630704086, 21892.723003201878, -16027.128508741638, 22436.057257610595, -10969.313039737803, 18328.386515343846, -8198.538744749992, 12663.316766271515},
{15.14, 0.57, -22558.281533603622, 22409.163292998644, -15647.830247453614, 22699.76944878022, -10840.344406817903, 18403.2529002476, -8225.475275373183, 12632.306698585357},
{15.14, 0.57, -24651.05710035952, 20019.08686432062, -18234.0445726982, 20646.115101860087, -13290.438726927214, 16732.33538796642, -10090.69341176581, 11222.59650481323},
{14.98, 0.57, -22696.65282101077, 22249.496839535575, -16378.054556193843, 22182.21390165414, -11869.405536248732, 17743.701580720634, -9190.535927356028, 11891.163968967801},
{15.14, 0.57, -24415.201716024923, 20378.101905886957, -17835.236996232834, 21015.71376749092, -12778.322079282576, 17068.7108335404, -9625.44352812635, 11528.246707238293},
{14.98, 0.56, -22021.210671193123, 22899.416927892078, -15252.499293538505, 22948.166563911098, -10541.1618954963, 18510.639442832246, -7980.210880305569, 12657.657047414132},
{14.98, 0.56, -23865.376109910965, 20973.62640750023, -17528.439320105346, 21263.697225644573, -12769.788416130415, 17026.32118785974, -9765.540473145787, 11333.46761672929},
{15.14, 0.57, -23585.276034736366, 21281.04230138624, -16301.377022998206, 22175.407771007638, -11009.815339583938, 18165.052849982632, -8039.288598712471, 12546.549258290572},
{15.14, 0.57, -23560.2260517633, 21273.36404079791, -17541.12327668314, 21263.956849434326, -12895.329179466737, 16903.046100501935, -9890.440846854735, 11159.471380332821},
{14.98, 0.56, -21074.7643282898, 23803.939555935776, -13659.196102229298, 23918.012144844808, -8747.828205201891, 19374.291863569473, -6389.960477714817, 13487.589672852695},
{14.98, 0.56, -24774.156574014163, 19990.224317896747, -18543.375164795965, 20328.95322820455, -13637.443460434752, 16194.984743171122, -10312.904353476215, 10590.189756394895},
{14.98, 0.56, -23103.133264601736, 21939.386810210828, -16622.150807149006, 21867.158090444576, -11929.595020579472, 17416.212627243774, -9057.04523638025, 11575.822467050099},
{14.98, 0.56, -22607.142360619328, 22434.1951899236, -15418.626351798921, 22773.215955547694, -10368.471451818574, 18401.072435293634, -7609.799451262151, 12580.133206527276},
{15.14, 0.57, -24175.677883257194, 20706.42805307301, -18175.479406111728, 20601.53324313529, -13438.230535663928, 16249.803975493047, -10225.524384788376, 10522.483927747207},
{15.14, 0.57, -24131.9349738298, 20734.764962942074, -16750.10773522577, 21750.45820055131, -11187.610838686755, 17876.13748021923, -8014.80560484744, 12308.769905746312},
{14.98, 0.56, -22282.997174296288, 22699.104505473417, -15364.665006565216, 22736.228778232555, -10517.040203145727, 18282.30881988149, -7821.614858967636, 12415.707427270374}
};
    

void loop() {
  static int i;
  delay(2000);
  if(Serial){
      Serial.print("Sending data package ");
      Serial.print(i);
      Serial.print(" over Wifi!\n"); 
  }
  write_data(wifi_package[i]);
  i = (i+1)&15;
}
